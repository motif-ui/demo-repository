name: Check Internal Issue Reference

on:
  pull_request:
    types: [labeled, opened, edited]

jobs:
  check-issue-reference:
    if: |
      contains(
        github.event.pull_request.labels.*.name,
        'internal'
      )
    runs-on: ubuntu-latest
    steps:
      - name: Check for Internal Issue Number in PR description
        shell: bash
        run: |
          PR_BODY="${{ github.event.pull_request.body }}"

          echo "üîç Checking PR description for internal issue reference..."

          if echo "$PR_BODY" | grep -Eq "#EDKUI-[0-9]+"; then
            ISSUE=$(echo "$PR_BODY" | grep -Eo "#EDKUI-[0-9]+")
            echo "‚úÖ Found internal issue reference: $ISSUE"
          else
            echo "‚ùå PR description must include an internal issue reference (e.g., #EDKUI-1288)"
            exit 1
          fi